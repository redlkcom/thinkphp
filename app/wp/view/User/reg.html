<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>注册</title>
    <base href="__STATIC__/home/">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/base.css">
    <link rel="stylesheet" type="text/css" href="css/regAndLogin.css">
    <link rel="stylesheet" type="text/css" href="css/reg.css">
    <script src="js/jquery.js"></script>
    <script src="js/reg.js"></script>
</head>

<body>
    <div class="header">
        <div class="top_nav">
            <div class="container">
                <div class="left">
                    <div class="pic">
                        <img src="images/common/header_icon.jpg" alt="">
                    </div>
                    <div>你好，欢迎来到京东！</div>
                    <div class="login"><a href="{:url('User/login')}">登录</a></div>
                    <div class="register"><a href="{:url('User/reg')}">注册</a></div>
                </div>
                <div class="right">
                    <ul>
                        <li><a href="{:url('Vip/index')}">会员中心</a></li>
                        <li>
                            <a href="{:url('Order/index')}">我的订单<img src="images/common/down_icon.png" alt=""></a>
                            <!-- <dl>
                                <dd><a href="order.html">我的订单</a></dd>
                                <dd><a href="order.html">我的订单</a></dd>
                                <dd><a href="order.html">我的订单</a></dd>
                                <dd><a href="order.html">我的订单</a></dd>
                            </dl> -->
                        </li>
                        <li>
                            <a href="#">网站导航<img src="images/common/down_icon.png" alt=""></a>
                            <!-- <dl>
                                <dd><a href="#">网站导航</a></dd>
                                <dd><a href="#">网站导航</a></dd>
                                <dd><a href="#">网站导航</a></dd>
                                <dd><a href="#">网站导航</a></dd>
                            </dl> -->
                        </li>
                        <li><a href="#">手机商城</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="top_content">
            <div class="container">
                <div class="left">
                    <div class="logo">
                        <a href="{:url('Index/index')}"><img src="images/common/logo.jpg" alt=""></a>
                    </div>
                </div>
                <div class="center">
                    <div class="table">
                        欢迎注册
                    </div>
                </div>
            </div>
            <div class="line"></div>
        </div>
    </div>
    <div class="middle">
        <div class="container clear">
            <div class="left fl">
                <ul class="clear top">
                    <li class="on">手机注册</li>
                    <li>邮箱注册</li>
                </ul>
                <ul class="clear down">
                    <li class="on">
                        <form action="" method="post" id="form1">
                        <div>
                            <label for="">用户账号：</label><input type="text" name="username" value="" required placeholder="用户账户" class="user">
                        </div>
                        <div>
                            <label for="">设置密码：</label><input type="password" name="pwd" value="" required placeholder="设置密码" class="pwd">
                        </div>
                        <div>
                            <label for="">确认密码：</label><input type="password"  value="" required placeholder="确认密码" class="cp_pwd">
                        </div>
                        <div>
                            <label for="">手机号码：</label><input type="text" name="tel" value="" required placeholder="手机号码" class="tel">
                        </div>
                        <div class="check">
                            <label for="">短信验证：</label><input type="text" name="code" value="" required placeholder="短信验证" class="code1"><button id="code1" class="code1" type="button">获取验证码</button>
                        </div>
                        <div class="protocol">
                            <label >
                                <input type="checkbox" value="" class="co">
                                <span>我已阅读并同意<a href="">《京东协议》</a></span>
                            </label>
                        </div>
                        <button id="btn1" class="agree" disabled>立即注册</button>
                    </form>
                    </li>
                    <li>
                        <form action="" method="post" id="form2">
                        <div>
                            <label for="">用户账号：</label><input type="text" name="username" value="" required placeholder="用户账户" class="user">
                        </div>
                        <div>
                            <label for="">设置密码：</label><input type="password" name="pwd" value="" required placeholder="设置密码" class="pwd">
                        </div>
                        <div>
                            <label for="">确认密码：</label><input type="password"  value="" required placeholder="确认密码" class="cp_pwd">
                        </div>
                        <div>
                            <label for="">用户邮箱：</label><input type="email" name="email" value="" required placeholder="用户邮箱" class="email">
                        </div>
                        <div class="check">
                            <label for="">邮箱验证：</label><input type="text" name="code" value="" required placeholder="邮箱验证" class="code2"><button id="code2" class="code2" type="button">获取验证码</button>
                        </div>
                        <div class="protocol">
                            <label >
                                <input type="checkbox" value="" class="co">
                                <span>我已阅读并同意<a href="">《京东协议》</a></span>
                            </label>
                        </div>
                        <button id="btn2" class="agree" disabled>立即注册</button>
                    </form>
                    </li>
                </ul>
            </div>
            <div class="right fl">
                <p>我已有京东账号</p>
                <p>现在就<a href="{:url('User/login')}">立即登录</a></p>
            </div>
        </div>

    </div>
    <div class="footer">
        <div class="bottom">
            <div class="container">
                <ul>
                    <li>沪ICP备13044278号</li>
                    <li>合字B1.B2-20130004</li>
                    <li>营业执照</li>
                    <li>互联网药品信息服务资格证</li>
                    <li>互联网药品交易服务资格证</li>
                </ul>
                <div class="copyright">
                    <span>Copyright©  京东饰品商城 2007-2016，All Rights Reserved</span>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="layui.js"></script>
<script type="text/javascript">
    layui.use('form', function(){
    var form = layui.form;
});
var u=0,p=0,e=0,c=0;
    $(function () {
    
      //账户验证
      $('#form1 .user').blur(function(){
          check_user1();
          check_form1();
      })
      //密码验证
      $('#form1 .pwd').blur(function(){
          check_pwd1();
          check_form1();
      })
      //重复密码验证
      $('#form1 .cp_pwd').blur(function(){
          check_cp_pwd1();
          check_form1();
      })
      //手机验证
      $('#form1 .tel').bind('blur ',function(){
          check_tel1();
          check_form1();
      })
      //验证协议
      $('#form1 .agree').click(function(){
        if(!$("#form1 .co").is(':checked')){
            layer.msg('请勾选协议');
            return false;
        }
      })
      //短信验证码
      $('#code1').click(function(){
          $(this).css("cursor",'not-allowed');
          var time = 60;
          $(this).attr("disabled", true);
          var tel=$('.tel').val();
          if (tel=='') {
            layer.msg('请填写手机号');
            return false;
          }
          $.ajax({
            type:"POST",
            url:"{:url('tel_ajax')}",
            data:"iphone="+tel,
            success:function(msg){
                switch(msg['result']){
                  case 0:
                  layer.msg('发送成功');
                  break;
                  default:
                  layer.msg('发送失败');
                  break;
                }
            }
          });
          var timer = setInterval(function() {
           if (time == 0) {
            clearInterval(timer);
            $('#code1').attr("disabled", false);
            $('#code1').html("获取验证码");
            $('#code1').css("cursor",'');
           } else {
            $('#code1').html(time + "秒");
            time--;
           }
          }, 1000);
      })
  })
    //账户验证
    function check_user1(){
        var user=$('#form1 .user').val();
        var reg=/^\w{5,12}$/;
        if(!reg.test(user)){
          u=0;
          layer.tips('请输入5-12位字母数字下划线的账户名！','#form1 .user',{tips:[3,'#3595cc'],anim:4});
          return false;
        }else{
            $.ajax({
                type:"POST",
                url :"{:url('ajax')}",
                data:"username="+user,
                success:function(msg){
                    if(msg==1){
                        u=0;
                        layer.tips('账户名已存在，请重新输入！','#form1 .user',{tips:[3,'#3595cc'],anim:4});
                        return false;
                    }else{
                        u=1;
                    }
                }
            });
        }
    }
    //密码验证
    function check_pwd1(){
        var pwd=$('#form1 .pwd').val();
        var reg=/^\w{5,12}$/;
        if(!reg.test(pwd)){
            p=0;
            layer.tips('请输入5-12位英文字母或数字下划线的密码','#form1 .pwd',{tips:[3,'#3595cc'],anim:4});
            return false;
        }else {
            p=1;
        }
    }
    //重复密码验证
    function check_cp_pwd1(){
        var cp_pwd=$('#form1 .cp_pwd').val();
        var pwd=$('#form1 .pwd').val();

        if(pwd!=cp_pwd){
            c=0;
            layer.tips('密码不一致','#form1 .cp_pwd',{tips:[3,'#3595cc'],anim:4});
            return false;
        }else {
            c=1;
        }
    }
    //手机验证
      function check_tel1(){
          var tel=$('#form1 .tel').val();
          var reg=/^1[3|4|5|7|8|9][0-9]{9}$/;
          if(!reg.test(tel)){
              e=0;
              layer.tips('请输入正确手机号码','#form1 .tel',{tips:[3,'#3595cc'],anim:4});
            return false;
          }else {
              $.ajax({
                  type:"POST",
                  url :"{:url('ajax')}",
                  data:"tel="+tel,
                  success:function(msg){
                      if(msg==1){
                          e=0;
                          layer.tips('手机号已存在，请重新输入！','#form1 .tel',{tips:[3,'#3595cc'],anim:4});
                        $('#form1 .code1').attr('disabled',true);
                            //return false;
                      }else{
                          e=1;
                          $('#form1 .code1').attr('disabled',false);
                      }
                  }
              });
          }

      }
    function check_form1(){
      console.log(u,p,c,e);
        if(u==1&&p==1&&c==1&&e==1){
           $('#btn1').attr('disabled',false);
        }else {
           $('#btn1').attr('disabled',true);
        }
    }

//邮箱注册
var uu=0,pp=0,ee=0,cc=0;
    $(function () {
    
      //账户验证
      $('#form2 .user').blur(function(){
          check_user2();
          check_form2();
      })
      //密码验证
      $('#form2 .pwd').blur(function(){
          check_pwd2();
          check_form2();
      })
      //重复密码验证
      $('#form2 .cp_pwd').blur(function(){
          check_cp_pwd2();
          check_form2();
      })
      //邮箱验证
      $('#form2 .email').bind('blur ',function(){
          check_email2();
          check_form2();
      })
      //验证协议
      $('#form2 .agree').click(function(){
        if(!$("#form2 .co").is(':checked')){
            layer.msg('请勾选协议');
            return false;
        }
      })
      //邮箱验证码
      $('#code2').click(function(){
          $(this).css("cursor",'not-allowed');
          var time = 60;
          $(this).attr("disabled", true);
          var email=$('.email').val();
          if (email=='') {
            layer.msg('请填写邮箱');
            return false;
          }
          $.ajax({
            type:"POST",
            url:"{:url('email_ajax')}",
            data:"email="+email,
            success:function(msg){
                switch(msg){
                  case 1:
                  layer.msg('发送成功');
                  break;
                  default:
                  layer.msg('发送失败');
                  break;
                }
            }
          });
          var timer = setInterval(function() {
           if (time == 0) {
            clearInterval(timer);
            $('#code2').attr("disabled", false);
            $('#code2').html("获取验证码");
            $('#code2').css("cursor",'');
           } else {
            $('#code2').html(time + "秒");
            time--;
           }
          }, 1000);
      })
  })
    //账户验证
    function check_user2(){
        var user=$('#form2 .user').val();
        var reg=/^\w{5,12}$/;
        if(!reg.test(user)){
          uu=0;
          layer.tips('请输入5-12位字母数字下划线的账户名！','#form2 .user',{tips:[3,'#3595cc'],anim:4});
          return false;
        }else{
            $.ajax({
                type:"POST",
                url :"{:url('ajax')}",
                data:"username="+user,
                success:function(msg){
                    if(msg==1){
                        uu=0;
                        layer.tips('账户名已存在，请重新输入！','#form2 .user',{tips:[3,'#3595cc'],anim:4});
                        return false;
                    }else{
                        uu=1;
                    }
                }
            });
        }
    }
    //密码验证
    function check_pwd2(){
        var pwd=$('#form2 .pwd').val();
        var reg=/^\w{5,12}$/;
        if(!reg.test(pwd)){
            pp=0;
            layer.tips('请输入5-12位英文字母或数字下划线的密码','#form2 .pwd',{tips:[3,'#3595cc'],anim:4});
            return false;
        }else {
            pp=1;
        }
    }
    //重复密码验证
    function check_cp_pwd2(){
        var cp_pwd=$('#form2 .cp_pwd').val();
        var pwd=$('#form2 .pwd').val();

        if(pwd!=cp_pwd){
            cc=0;
            layer.tips('密码不一致','#form2 .cp_pwd',{tips:[3,'#3595cc'],anim:4});
            return false;
        }else {
            cc=1;
        }
    }
    //邮箱验证
      function check_email2(){
          var email=$('#form2 .email').val();
          var reg=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;
          if(!reg.test(email)){
              ee=0;
              layer.tips('请输入正确邮箱','#form2 .email',{tips:[3,'#3595cc'],anim:4});
            return false;
          }else {
              $.ajax({
                  type:"POST",
                  url :"{:url('ajax')}",
                  data:"email="+email,
                  success:function(msg){
                      if(msg==1){
                          ee=0;
                          layer.tips('邮箱已存在，请重新输入！','#form2 .email',{tips:[3,'#3595cc'],anim:4});
                          $('#form2 .code2').attr('disabled',true);
                            //return false;
                      }else{
                          ee=1;
                          $('#form2 .code2').attr('disabled',false);
                      }
                  }
              });
          }

      }
    function check_form2(){
      console.log(uu,pp,cc,ee);
        if(uu==1&&pp==1&&cc==1&&ee==1){
           $('#btn2').attr('disabled',false);
        }else {
           $('#btn2').attr('disabled',true);
        }
    }
</script>
</html>